<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Redeem — Travel</title>
    <link rel="stylesheet" href="./CSS/main.css" />
    <link rel="stylesheet" href="./CSS/redeem.css" />
  </head>
  <body>
    <header class="lp-header">
      <a class="brand" href="./main.html">Travel</a>
      <div class="lp-grow"></div>
      <button id="settingsBtn" class="icon-btn" aria-expanded="false">
        ⚙️
      </button>
      <div id="settingsMenu" class="menu" aria-hidden="true">
        <a href="./currenttrip.html">Current trip</a>
        <a href="./cart.html">Cart</a>
        <a href="./transportation.html">Transportation</a>
        <a class="active" href="./redeem.html">Redeem</a>
        <a href="./deals.html">Deals</a>
        <a href="./account.html">Account</a>
      </div>
      <button id="avatarBtn" class="avatar-btn" aria-expanded="false">
        <span id="avatarInitial">U</span>
      </button>
      <div id="userMenu" class="menu" aria-hidden="true">
        <a href="./account.html">Account</a>
        <button id="logoutBtn" class="link danger">Log out</button>
      </div>
    </header>

    <main class="shell">
      <section class="card">
        <h2>Have a promo code?</h2>
        <p class="muted">
          Codes apply on this device and can be removed anytime.
        </p>
        <div class="row">
          <input
            id="code"
            class="code"
            placeholder="Enter code (e.g., WELCOME10)"
          />
          <button class="btn" id="apply">Apply</button>
          <button class="btn-ghost" id="remove">Remove</button>
        </div>
      </section>

      <section class="card">
        <h2>Totals with promo</h2>
        <div class="sum">
          <div class="line">
            <span>Cart subtotal</span><strong id="sub">₹0</strong>
          </div>
          <div class="line">
            <span>Service (0.5%)</span><strong id="serv">₹0</strong>
          </div>
          <div class="line">
            <span>Tax (12%)</span><strong id="tax">₹0</strong>
          </div>
          <div class="line">
            <span>Promo (<span id="promoPct">0%</span>)</span
            ><strong id="disc">−₹0</strong>
          </div>
          <div class="line" style="font-size: 18px">
            <span>Final total</span><strong id="tot">₹0</strong>
          </div>
        </div>
        <div style="margin-top: 12px" class="btns">
          <a class="btn-outline" href="./currenttrip.html"
            >Back to Current Trip</a
          >
        </div>
      </section>
    </main>

    <div id="toasts"></div>
    <script src="./JS/main.js"></script>
    <script>
      // header fallback
      (function () {
        const s = document.getElementById("settingsBtn"),
          m = document.getElementById("settingsMenu");
        const a = document.getElementById("avatarBtn"),
          u = document.getElementById("userMenu");
        function close() {
          [m, u].forEach((x) => x?.classList.remove("open"));
          [s, a].forEach((b) => b?.setAttribute("aria-expanded", "false"));
        }
        function tog(btn, menu) {
          const o = menu?.classList.contains("open");
          close();
          if (!o) {
            menu?.classList.add("open");
            btn?.setAttribute("aria-expanded", "true");
          }
        }
        s?.addEventListener("click", (e) => {
          e.stopPropagation();
          tog(s, m);
        });
        a?.addEventListener("click", (e) => {
          e.stopPropagation();
          tog(a, u);
        });
        document.addEventListener("click", (e) => {
          if (
            !m?.contains(e.target) &&
            !s?.contains(e.target) &&
            !u?.contains(e.target) &&
            !a?.contains(e.target)
          )
            close();
        });
        document.getElementById("logoutBtn")?.addEventListener("click", () => {
          localStorage.removeItem("sessionClient");
          location.reload();
        });
      })();
    </script>
    <script src="./JS/redeem.js"></script>
  </body>
</html>
