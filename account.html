<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Account — Travel</title>
    <link rel="stylesheet" href="./CSS/main.css" />
    <link rel="stylesheet" href="./CSS/account.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="header-left">
        <a class="logo-button" href="main.html" aria-label="Home">
          <img src="./assets/logo.png" alt="" />
        </a>
      </div>
      <nav class="header-center">
        <ul class="nav">
          <li><a href="places/INDmap.html">Explore</a></li>
          <li><a href="transportation.html">Transportation</a></li>
          <li><a href="deals.html">Deals</a></li>
          <li><a href="about.html">About Us</a></li>
        </ul>
      </nav>
      <div class="header-right">
        <button
          id="settingsBtn"
          class="icon-btn guest-only"
          aria-haspopup="menu"
          aria-expanded="false"
          aria-controls="settingsMenu"
        >
          ⚙️
        </button>
        <button
          id="avatarBtn"
          class="avatar-btn auth-only"
          aria-haspopup="menu"
          aria-expanded="false"
          aria-controls="userMenu"
        >
          <span id="avatarInitial">U</span>
        </button>
        <div
          id="settingsMenu"
          class="menu guest-only"
          role="menu"
          aria-hidden="true"
        >
          <a class="menu-item" href="auth.html?tab=login">Login</a>
          <a class="menu-item" href="auth.html?tab=register">Register</a>
        </div>
        <div
          id="userMenu"
          class="menu auth-only"
          role="menu"
          aria-hidden="true"
        >
          <a class="menu-item" href="account.html" role="menuitem">Account</a>
          <a class="menu-item" href="currenttrip.html" role="menuitem"
            >Your Current Trip</a
          >

          <a class="menu-item" href="points.html" role="menuitem"
            >Points Redeem</a
          >
          <a class="menu-item" href="cart.html" role="menuitem">Cart</a>
          <button class="menu-item danger" id="logoutBtn" role="menuitem">
            Logout
          </button>
        </div>
      </div>
    </header>

    <main class="shell">
      <!-- Signed-out blurb -->
      <section id="signedOut" class="card hide">
        <h2>You're not signed in</h2>
        <p class="muted">
          Sign in to view and manage your profile, trips, points, and purchase
          history.
        </p>
        <div class="btns">
          <a class="btn" href="./auth.html">Sign in / Register</a>
        </div>
      </section>

      <!-- Identity + Security -->
      <div id="signedIn" class="grid">
        <section class="card">
          <h2>Your profile</h2>

          <!-- View mode -->
          <div id="profileView">
            <div class="row">
              <div class="avatar" id="accAvatar">U</div>
              <div>
                <div id="accName" class="h3">Guest</div>
                <div id="accEmail" class="muted">—</div>
              </div>
            </div>
            <div class="kv">
              <div>Phone</div>
              <div id="accPhone">—</div>
            </div>
            <div class="kv">
              <div>Address</div>
              <div id="accAddr">—</div>
            </div>
            <div class="btns">
              <button class="btn-outline" id="editToggle">Edit details</button>
            </div>
          </div>

          <!-- Edit mode -->
          <div id="profileForm" class="form hide" aria-hidden="true">
            <div class="field">
              <label for="firstName">First name</label><input id="firstName" />
            </div>
            <div class="field">
              <label for="lastName">Last name</label><input id="lastName" />
            </div>
            <div class="field">
              <label for="phone">Phone</label><input id="phone" />
            </div>
            <div class="field">
              <label for="address">Address</label
              ><textarea id="address" rows="2"></textarea>
            </div>
            <div class="btns">
              <button class="btn" id="saveProfile">Save</button>
              <button
                class="btn-ghost"
                type="button"
                id="editToggleCancel"
                onclick="document.getElementById('editToggle').click()"
              >
                Cancel
              </button>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>Security</h2>
          <p class="muted">Change your password.</p>
          <form id="pwForm" class="form">
            <div class="field">
              <label for="currentPassword">Current password (optional)</label>
              <input
                id="currentPassword"
                type="password"
                autocomplete="current-password"
              />
            </div>
            <div class="field">
              <label for="newPassword">New password</label>
              <input
                id="newPassword"
                type="password"
                autocomplete="new-password"
              />
            </div>
            <div class="field">
              <label for="confirmPassword">Confirm new password</label>
              <input
                id="confirmPassword"
                type="password"
                autocomplete="new-password"
              />
            </div>
            <div class="btns popover-anchor">
              <button class="btn" id="pwSubmit" type="submit">
                Update password
              </button>
              <div
                id="pwPopover"
                class="popover"
                role="status"
                aria-live="polite"
                hidden
              >
                <div class="popover-arrow"></div>
                <div class="popover-body"></div>
              </div>
            </div>
          </form>
        </section>
      </div>

      <!-- Mini summary (recent items) -->
      <section class="card">
        <h2>Trip summary</h2>
        <div id="accSummary" class="list">
          <div class="muted">Loading…</div>
        </div>
      </section>

      <!-- Trips block with simple tabs -->
      <section class="card">
        <h2>Your trips</h2>
        <div class="tabs" role="tablist">
          <button
            class="tab"
            role="tab"
            aria-selected="true"
            onclick="document.getElementById('tabUpcoming').classList.remove('hide');document.getElementById('tabDone').classList.add('hide');this.setAttribute('aria-selected','true');this.nextElementSibling.setAttribute('aria-selected','false')"
          >
            Upcoming
          </button>
          <button
            class="tab"
            role="tab"
            aria-selected="false"
            onclick="document.getElementById('tabUpcoming').classList.add('hide');document.getElementById('tabDone').classList.remove('hide');this.setAttribute('aria-selected','true');this.previousElementSibling.setAttribute('aria-selected','false')"
          >
            Completed
          </button>
        </div>
        <div id="tabUpcoming">
          <div id="accTripsUpcoming" class="list">
            <div class="muted">Loading…</div>
          </div>
        </div>
        <div id="tabDone" class="hide">
          <div id="accTripsDone" class="list">
            <div class="muted">Loading…</div>
          </div>
        </div>
      </section>

      <!-- Points -->
      <section class="card">
        <h2>Points</h2>
        <div class="kv">
          <div>Available</div>
          <div class="h3" id="accPoints">—</div>
        </div>
        <div class="callout">
          <span id="accPointsRule" class="muted small"></span>
        </div>
        <div class="btns">
          <a class="btn" href="./points.html">Use points</a>
        </div>
      </section>

      <!-- Purchases -->
      <section class="card">
        <h2>Purchase history</h2>
        <div id="accPurchases" class="list">
          <div class="muted">Loading…</div>
        </div>
      </section>

      <!-- Device cart -->
      <section class="card">
        <h2>Saved cart (device)</h2>
        <div id="accCartLocal" class="list"></div>
        <div class="btns">
          <a class="btn-outline" href="./currenttrip.html">Open Current Trip</a>
          <button class="btn-ghost danger" id="clearLocal">
            Clear local cart
          </button>
        </div>
      </section>
    </main>

    <div id="toasts"></div>

    <script src="./JS/main.js"></script>
    <script src="./JS/account.js"></script>
  </body>
</html>
